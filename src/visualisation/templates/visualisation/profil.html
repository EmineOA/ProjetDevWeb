{% extends 'base.html' %}

{% block title %}Mon Profil{% endblock %}

{% block content %}
<div class="container-fluid">
  <div class="row">
    <!-- Sidebar pour la page profil -->
      <nav class="col-md-3 col-lg-2 d-md-block bg-light sidebar collapse">
        <div class="position-sticky pt-3">
          <ul class="nav flex-column">
            <li class="nav-item">
              <a class="nav-link {% if request.resolver_match.url_name == 'visualisation_home' %}active{% endif %}" href="{% url 'visualisation_home' %}">
                <span data-feather="home"></span> Tableau de Bord
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link {% if request.resolver_match.url_name == 'visualisation_objets' %}active{% endif %}" href="{% url 'visualisation_objets' %}">
                <span data-feather="layers"></span> Objets Connectés
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link {% if request.resolver_match.url_name == 'visualisation_profil' %}active{% endif %}" href="{% url 'visualisation_profil' %}">
                <span data-feather="user"></span> Profil
              </a>
            </li>
          </ul>
          <!-- Bouton pour rechercher d'autres membres -->
          <div class="mt-3">
            <a href="{% url 'view_profiles' %}" class="btn btn-outline-primary btn-block">Chercher d'autres membres</a>
          </div>
        </div>
      </nav>

    <!-- Zone de contenu principal -->
    <main class="col-md-9 ml-sm-auto col-lg-10 px-md-4">
      <!-- Informations Publiques -->
      <div class="card mb-4">
        <div class="card-header">
          Informations publiques
          <!-- Bouton "Modifier mon profil" placé ici -->
          <a href="{% url 'edit_profil' %}" class="btn btn-sm btn-primary float-right">Modifier mon profil</a>
        </div>
        <div class="card-body">
          <p><strong>Username :</strong> {{ user.username }}</p>
          <p><strong>Nom :</strong> {{ user.get_full_name|default:"Non renseigné" }}</p>
          <p><strong>Email :</strong> {{ user.email }}</p>
          <p><strong>XP :</strong> {{ user.xp }}</p>
          <p><strong>Niveau :</strong> {{ user.niveau }}</p>
          <!-- Ajoutez d'autres informations publiques si nécessaire -->
        </div>
      </div>

      <!-- Informations Privées (Formulaire de changement de mot de passe uniquement) -->
      <div class="card mb-4">
        <div class="card-header">
          Mon Profil Privé
        </div>
        <div class="card-body">
          <h5>Changer mon mot de passe</h5>
          <form method="post" action="{% url 'change_password' %}">
            {% csrf_token %}
            <div class="mb-3">
              <label for="old_password" class="form-label">Ancien mot de passe</label>
              <input type="password" class="form-control" id="old_password" name="old_password" required>
            </div>
            <div class="mb-3">
              <label for="new_password1" class="form-label">Nouveau mot de passe</label>
              <input type="password" class="form-control" id="new_password1" name="new_password1" required>
            </div>
            <div class="mb-3">
              <label for="new_password2" class="form-label">Confirmer le nouveau mot de passe</label>
              <input type="password" class="form-control" id="new_password2" name="new_password2" required>
            </div>
            <button type="submit" class="btn btn-primary">Changer mon mot de passe</button>
          </form>
        </div>
      </div>
    </main>
  </div>
</div>
{% endblock %}
